<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SECURE FILE VIEW // GLITCHED RECORDS</title>
    <style>
        body { background-color: #080808; color: #C0C0C0; font-family: 'Courier New', Courier, monospace; margin: 0; padding: 40px; line-height: 1.5; max-width: 900px; margin: 0 auto; border-left: 1px solid #333; border-right: 1px solid #333; min-height: 100vh; }
        body::before { content: " "; display: block; position: fixed; top: 0; left: 0; bottom: 0; right: 0; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03)); z-index: 2; background-size: 100% 2px, 3px 100%; pointer-events: none; }
        h1 { color: #D4AF37; text-transform: uppercase; border-bottom: 2px solid #D4AF37; padding-bottom: 10px; font-size: 24px; letter-spacing: 2px; }
        .meta-header { font-size: 12px; color: #555; margin-bottom: 40px; border-bottom: 1px solid #333; padding-bottom: 10px; display: flex; justify-content: space-between; }
        .content { white-space: pre-wrap; font-size: 14px; }
        .footer-nav { margin-top: 60px; padding-top: 20px; border-top: 1px solid #333; text-align: center; }
        a.btn { color: #000; background-color: #D4AF37; text-decoration: none; padding: 10px 20px; font-weight: bold; font-size: 12px; text-transform: uppercase; transition: 0.3s; }
        a.btn:hover { background-color: #FFF; box-shadow: 0 0 10px #D4AF37; }
        #loading { color: #D4AF37; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body>
    <div class="meta-header">
        <span>SECURITY LEVEL: OMNI</span>
        <span>ORIGIN: MATRIARCH.CODES</span>
        <span id="status">LOADING...</span>
    </div>

    <h1 id="doc-title">INITIALIZING...</h1>
    <div id="content" class="content"><span id="loading">decryption_in_progress...</span></div>

    <div class="footer-nav">
        <a href="index.html" class="btn"><< RETURN TO ROOT DIRECTORY</a>
    </div>

    <script>
        // 1. Get the filename from the URL (e.g., reader.html?file=grimoire.txt)
        const urlParams = new URLSearchParams(window.location.search);
        const file = urlParams.get('file');

        if (file) {
            // 2. Set the Title based on the filename
            document.getElementById('doc-title').innerText = file.replace('.txt', '').replace(/_/g, ' ').toUpperCase();

            // 3. Fetch the actual text file
            fetch(file)
                .then(response => {
                    if (!response.ok) throw new Error("FILE_NOT_FOUND");
                    return response.text();
                })
                .then(text => {
                    // 4. Inject the full text into the page
                    document.getElementById('content').innerText = text;
                    document.getElementById('status').innerText = "STATUS: DECRYPTED";
                })
                .catch(error => {
                    document.getElementById('content').innerHTML = "<span style='color:red'>ERROR: FILE CORRUPTED OR MISSING. CHECK ARCHIVE.</span>";
                    document.getElementById('status').innerText = "STATUS: ERROR";
                });
        } else {
            document.getElementById('content').innerText = "ERROR: NO FILE SPECIFIED.";
        }
    </script>
</body>
</html>
